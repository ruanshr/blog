# 请阐述一下对vue虚拟dom的理解

### 1、什么是虚拟dom

虚拟dom本质上就是一个普通的JS对象，用于描述石头的界面结构

在vue中每个组件都有一个render函数，每个render函数都会返回一个虚拟dom树，这也就是意味着每个组件都对应一颗虚拟DOM树

### 2、为什么需要虚拟DOM？

在vue中，渲染视图会调用render函数，这种渲染不仅发生在组件创建时，同时发生在石头依赖的数据更新时，如果在渲染是，，直接使用真实DOM，由于真实DOM的创建，更新，插入等操作都会带来性能损耗，而就会极大地降低渲染效率

### 3、虚拟dom是如何转换为真实DOM

在一个组件实例首次被渲染时，它先生产虚拟DOM树，然后根据虚拟DOM树创建真实DOM，并把真实DOM挂载到页面中合适的位置，此时，每个虚拟DOM便会对应一个真实的DOM，

如果一个组件受响应式数据变化的影响，需要重新渲染时，它仍然会重新调用render函数，创新出一个新的虚拟dom树，用新树和旧树对比，通过对比，vue会找到最小更新量，然后更新必要的您dom节点，最后这些更新过的虚拟节点，会修改他们对应的真实dom

这样一来，就保证了对真实dom达到最小的改动


### 4、模板与虚拟dom的关系

vue框架中有一个compile模板，它主要负责将模板转换成render函数，而render函数调用后得到虚拟dom

编译的过程分两步：

1、将模板字符转换成ast
2、将ast转换成render函数

如果使用传统的引入方式,则编译时间发生在组件第一次加载时，这称之为运行时编译。
如果是在vue-cli的默认配置下，编译发生在打包时，这种称之为模板预编译。

编译时一个极其耗费性能的操作，预编译可以有效的提高运行时的性能，而且，由于运行的时候已经不需要编译模板的存在，仅仅时为了让开发人员更加方便的书写节目代码。

**vue最终运行的时候，最终需要的时render函数，而不是模板，因此模板中的各种语法，在虚拟dom中都是不存在的，他们都会变成虚拟dom**



